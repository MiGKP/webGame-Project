<app-navbar></app-navbar>

<div class="all-games-container">
  <h1>All Games in Store</h1>
  
  <div *ngIf="!isLoading; else loadingTemplate" class="games-grid">
    <div *ngFor="let game of games" class="game-card">
      <div class="game-image-container">
        <img [src]="game.imageUrl" [alt]="game.name" class="game-image">
      </div>
      <div class="game-details">
        <h3>{{ game.name }}</h3>
        <p class="game-category">{{ game.category }}</p>
        <p class="game-date">วางจำหน่าย: {{ game.releaseDate?.toDate() | date:'dd/MM/yyyy' }}</p>
        <p class="game-price">฿ {{ game.price | number }}</p>
      </div>
      <div class="game-actions">
        <button class="edit-btn" (click)="openEditModal(game)">แก้ไข</button>
        <button class="delete-btn" (click)="onDeleteGame(game.id)">ลบ</button>
      </div>
    </div>
  </div>
</div>

<ng-template #loadingTemplate>
  <div class="loading-spinner"></div>
</ng-template>

<!-- Edit Modal -->
<div *ngIf="isEditModalOpen" class="modal-overlay" (click)="closeEditModal()">
  <div class="modal-content" (click)="$event.stopPropagation()" *ngIf="currentGame">
    <h2>Edit Game</h2>
    <form (ngSubmit)="onUpdateGame()">
      <div class="form-group">
        <label for="name">Game Name</label>
        <input id="name" type="text" [(ngModel)]="currentGame.name" name="name" required>
      </div>
      <div class="form-group">
        <label for="category">Category</label>
        <!-- แก้ไขจาก input เป็น select -->
        <select id="category" [(ngModel)]="currentGame.category" name="category" required>
          <option *ngFor="let category of categories" [value]="category">{{ category }}</option>
        </select>
      </div>
      <div class="form-group">
        <label for="description">Description</label>
        <textarea id="description" [(ngModel)]="currentGame.description" name="description" required rows="4"></textarea>
      </div>
      <div class="form-group">
        <label for="price">Price</label>
        <input id="price" type="number" [(ngModel)]="currentGame.price" name="price" required>
      </div>
      <div class="modal-actions">
        <button type="button" class="cancel-btn" (click)="closeEditModal()">Cancel</button>
        <button type="submit" class="save-btn">Save Changes</button>
      </div>
    </form>
  </div>
</div>

